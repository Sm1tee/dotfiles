"use strict";(()=>{var ko=Object.defineProperty;var ho=(n,e,o)=>e in n?ko(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o;var X=(n,e,o)=>(ho(n,typeof e!="symbol"?e+"":e,o),o);var u=[];var M=globalThis.browser??globalThis.chrome;function ve(n){return n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}var De={modal:!0,open:!0};function Ie(n){let e=document.createElement("sqrx-dialog"),{messages:o}=n;delete n.messages;for(let i of Object.keys(De)){let R=i;n[R]=n[R]??De[R]}let r=n.onReady,t=n.onDismiss,a=n.onConfirm;return delete n.onReady,delete n.onDismiss,delete n.onConfirm,r&&e.addEventListener("ready",r),t&&e.addEventListener("dismiss",t),a&&e.addEventListener("confirm",a),e.addEventListener("ready",()=>{for(let L of Object.keys(n)){let $=n[L];$!=null&&$!==!1&&e.setAttribute(ve(L),$.toString())}let i=document.createElement("div");i.classList.add("title"),i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i.style.gap="0.75em";let R=document.createElement("h3");R.textContent=n.title,e.append(i);let w=document.createElement("img");w.style.width="48px",w.style.height="48px",w.src=M.runtime.getURL("assets/icon.png"),i.append(w),i.append(R),o&&o.forEach(L=>{let $=document.createElement("p");$.textContent=L,e.append($)})}),e}var Bo=function(n,e,o,r,t){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!t)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!t:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?t.call(n,o):t?t.value=o:e.set(n,o),o},Ro=function(n,e,o,r){if(o==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return o==="m"?r:o==="a"?r.call(n):r?r.value:e.get(n)},re,h=class extends Error{constructor(e,o){super(o),re.set(this,void 0),Bo(this,re,e,"f")}get key(){return Ro(this,re,"f")}};re=new WeakMap;function v(n,e,o){return(r,t="")=>{try{let a=e.reduce((i,R)=>R(i,t),r);return o?.(a,t),bo(t,n,a)}catch(a){return Pe(r,a)}}}function Pe(n,e){return{initialValue:n,hasError:!0,error:e}}function bo(n,e,o){try{return e.forEach(r=>r(o,n)),{initialValue:o,result:o,hasError:!1}}catch(r){return Pe(o,r)}}var U=(n,e,o,r)=>(t,a="")=>{if(!(n?!e(t):e(t)))throw new h(a,`${o??typeof t} '${t}' ${n?"is":"is not"} ${r}`)};function wo(n,e,o,r){return`${n} ${e} is${r?" ":" not "}${o}`}function K(n){return(e,o,r,t,a)=>{if(!o())throw new h(e,wo(n,r,t,a))}}var te=K("array"),Ae=n=>e=>(o,r="")=>{te(r,()=>n?o.length!==e:o.length===e,`of length ${o.length}`,`of exact length ${e}`,n)},So=n=>e=>(o,r="")=>{te(r,()=>n?o.length<e:o.length>=e,`of length ${o.length}`,`within minimum length of ${e}`,n)},vo=n=>e=>(o,r="")=>{te(r,()=>n?o.length>e:o.length<=e,`of length ${o.length}`,`within maximum length of ${e}`,n)},Me=n=>()=>(e,o="")=>{te(o,()=>n?e.length!==0:e.length===0,`of length ${e.length}`,"empty",n)};function Z(n=[]){let e=[],o=v(e,n,(r,t="")=>{if(!Array.isArray(r))throw new h(t,`Value ${r} is not an array`)});return o.toString=D(o,r=>r.join(", ")),o.toNumber=I(o,r=>Number(r)),o.toBoolean=P(o,r=>!!r),o.toCustom=b(o),o.assert=(r,t)=>(e.push(U(!1,r,"array",t)),o),o.ofExactLength=r=>(e.push(Ae(!1)(r)),o),o.ofMinLength=r=>(e.push(So(!1)(r)),o),o.ofMaxLength=r=>(e.push(vo(!1)(r)),o),o.empty=()=>(e.push(Me(!1)()),o),o.not={assert:(r,t)=>(e.push(U(!0,r,"array",t)),o),empty:()=>(e.push(Me(!0)()),o),ofExactLength:r=>(e.push(Ae(!0)(r)),o)},o.items=function(r){return Z([(t,a="")=>{let i=o(t,a);if(i.hasError)throw i.error;let R=i.result.map((w,L)=>r(w,[a,`[${L}]`].filter(Boolean).join(".")));if(R.some(w=>w.hasError))throw R.filter(w=>w.hasError);return R.reduce((w,L)=>(L.hasError||w.push(L.result),w),[])}])},o}var Oe=K("boolean"),Le=n=>()=>(e,o="")=>{Oe(o,()=>n?!e:e,e,"true",n)},Ue=n=>()=>(e,o="")=>{Oe(o,()=>n?e:!e,e,"false",n)};function ae(n=[]){let e=[],o=v(e,n,(t,a="")=>{if(typeof t!="boolean")throw new h(a,`Value ${t} is not a boolean`)});o.toString=D(o,t=>t.toString()),o.toNumber=I(o,t=>t?1:0),o.toBoolean=P(o,t=>t),o.toCustom=b(o),o.toArray=N(o);let r=t=>(a,i)=>(e.push(U(t,a,"boolean",i)),o);return o.assert=r(!1),o.true=()=>(e.push(Le(!1)()),ee(!0,o)),o.false=()=>(e.push(Ue(!1)()),ee(!1,o)),o.not={assert:r(!0),true:()=>(e.push(Le(!0)()),ee(!1,o)),false:()=>(e.push(Ue(!0)()),ee(!0,o))},o}function Ne(n=[]){let o=v([],n,(r,t="")=>{if(typeof r!="boolean")throw new h(t,`Value ${r} is not a boolean`);if(r!==!1)throw new h(t,`Value ${r} must be false`)});return o.toString=D(o,r=>r.toString()),o.toNumber=I(o,r=>r?1:0),o.toBoolean=P(o,r=>r),o.toCustom=b(o),o.toArray=N(o),o}function $e(n=[]){let o=v([],n,(r,t="")=>{if(typeof r!="boolean")throw new h(t,`Value ${r} is not a boolean`);if(r!==!0)throw new h(t,`Value ${r} must be true`)});return o.toString=D(o,r=>r.toString()),o.toNumber=I(o,r=>r?1:0),o.toBoolean=P(o,r=>r),o.toCustom=b(o),o.toArray=N(o),o}function Ve(n=[]){let e=[],o=v(e,n);o.toString=D(o,()=>""),o.toNumber=I(o,()=>0),o.toBoolean=P(o,()=>!1),o.toCustom=b(o),o.toArray=N(o);let r=t=>(a,i)=>(e.push(U(t,a,"custom value",i)),o);return o.assert=r(!1),o.not={assert:r(!0)},o}var G=K("number"),je=n=>e=>(o,r="")=>{if(!(n?e.indexOf(o)===-1:e.indexOf(o)!==-1))throw new h(r,`Number value ${o} ${n?`is one of the disallowed values in [${e.join(", ")}]`:`is not one of the allowed values in [${e.join(", ")}]`}`)},ze=n=>()=>(e,o="")=>{G(o,()=>n?e<0:e>0,e,"positive",n)},qe=n=>()=>(e,o="")=>{G(o,()=>n?e>0:e<0,e,"negative",n)},Ke=n=>()=>(e,o="")=>{G(o,()=>n?e!==0:e===0,e,"zero",n)},Ge=n=>e=>(o,r="")=>{G(r,()=>n?o>=e:o<e,o,`less than ${e}`,n)},We=n=>e=>(o,r="")=>{G(r,()=>n?o<=e:o>e,o,`more than ${e}`,n)},He=n=>e=>(o,r="")=>{G(r,()=>n?o!==e:o===e,o,`equal to ${e}`,n)},Je=n=>e=>(o,r="")=>{G(r,()=>n?o%e!==0:o%e===0,o,`a multiple of ${e}`,n)},Qe=n=>()=>(e,o="")=>{G(o,()=>n?!Number.isInteger(e):Number.isInteger(e),e,"an integer",n)};function se(n=[]){let e=[],o=v(e,n,(t,a="")=>{if(typeof t!="number")throw new h(a,`Value ${t} is not a number`)});o.toString=D(o,t=>t.toString()),o.toNumber=I(o,t=>t),o.toBoolean=P(o,t=>t!==0),o.toCustom=b(o),o.toArray=N(o);let r=t=>(a,i)=>(e.push(U(t,a,"number",i)),o);return o.assert=r(!1),o.allowed=(...t)=>(e.push(je(!1)(t)),o),o.integer=()=>(e.push(Qe(!1)()),o),o.positive=()=>(e.push(ze(!1)()),o),o.negative=()=>(e.push(qe(!1)()),o),o.lessThan=t=>(e.push(Ge(!1)(t)),o),o.moreThan=t=>(e.push(We(!1)(t)),o),o.zero=()=>(e.push(Ke(!1)()),o),o.multipleOf=t=>(e.push(Je(!1)(t)),o),o.equals=t=>(e.push(He(!1)(t)),o),o.not={assert:r(!0),allowed:(...t)=>(e.push(je(!0)(t)),o),integer:()=>(e.push(Qe(!0)()),o),positive:()=>(e.push(ze(!0)()),o),negative:()=>(e.push(qe(!0)()),o),lessThan:t=>(e.push(Ge(!0)(t)),o),moreThan:t=>(e.push(We(!0)(t)),o),zero:()=>(e.push(Ke(!0)()),o),multipleOf:t=>(e.push(Je(!0)(t)),o),equals:t=>(e.push(He(!0)(t)),o)},o}function ie(n=[]){let e=[],o=v(e,n);o.toCustom=b(o);let r=t=>(a,i)=>(e.push(U(t,a,"custom value",i)),o);return o.assert=r(!1),o.not={assert:r(!0)},o}function D(n,e){return(o=e)=>ue([(r,t="")=>{let a=n(r,t);if(a.hasError)throw a.error;try{return o(a.result)}catch(i){throw new h(t,`Unable to create a string from ${typeof a.result} ${a.result}

 ${i instanceof Error?i.message:i}`)}}])}function I(n,e){return(o=e)=>se([(r,t="")=>{let a=n(r,t);if(a.hasError)throw a.error;try{return o(a.result)}catch(i){throw new h(t,`Unable to create a number from ${typeof a.result} ${a.result}

 ${i instanceof Error?i.message:i}`)}}])}function P(n,e){return(o=e)=>ae([(r,t="")=>{let a=n(r,t);if(a.hasError)throw a.error;try{return o(a.result)}catch(i){throw new h(t,`Unable to create a booolean from ${typeof a.result} ${a.result}

 ${i instanceof Error?i.message:i}`)}}])}function b(n){return e=>Ve([(o,r="")=>{let t=n(o,r);if(t.hasError)throw t.error;try{return e(t.result)}catch(a){throw new h(r,`Unable to create custom type from ${typeof t.result} ${t.result}

 ${a instanceof Error?a.message:a}`)}}])}function N(n){return e=>Z([(o,r="")=>{let t=n(o,r);if(t.hasError)throw t.error;try{return e(t.result)}catch(a){throw new h(r,`Unable to create an array from ${typeof t.result} ${t.result}

 ${a instanceof Error?a.message:a}`)}}])}function Fe(n){return ie([(e,o="")=>{let r=n(e,o);if(r.hasError)throw r.error;return e}])}function ee(n,e){return(n?$e:Ne)([(r,t="")=>{let a=e(r,t);if(a.hasError)throw a.error;return r}])}var oo=K("string"),Ye=(n,e)=>o=>(r,t="")=>{oo(t,()=>{let a=e?o:o.toLowerCase(),i=e?r:r.toLowerCase();return n?i!==a:i===a},r,"equal to",n)},Xe=(n,e)=>o=>(r,t="")=>{let a=e?o:o.map(w=>w.toLowerCase()),i=e?r:r.toLowerCase();if(!(n?a.indexOf(i)===-1:a.indexOf(i)!==-1))throw new h(t,`String value ${r} ${n?`is one of the disallowed values in [${o.join(", ")}]`:`is not one of the allowed values in [${o.join(", ")}]`}`)},Ze=n=>()=>(e,o="")=>{oo(o,()=>n?e.length!==0:e.length===0,e,"empty",n)},eo=n=>e=>(o,r="")=>{if(!(n?!e.test(o):e.test(o)))throw new h(r,`String value '${o}' ${n?"matches":"does not match"} pattern ${e}`)};function ue(n=[]){let e=[],o={enabled:!0},r=v(e,n,(a,i="")=>{if(typeof a!="string")throw new h(i,`Value ${a} is not a string`)});r.toString=D(r,a=>a),r.toNumber=I(r,a=>Number(a)),r.toBoolean=P(r,a=>!!a),r.toCustom=b(r),r.toArray=N(r);let t=a=>(i,R)=>(e.push(U(a,i,"string",R)),r);return r.assert=t(!1),r.allowed=(...a)=>(e.push(Xe(!1,o.enabled)(a)),Fe(r)),r.matches=a=>(e.push(eo(!1)(a)),r),r.empty=()=>(e.push(Ze(!1)()),r),r.equals=a=>(e.push(Ye(!1,o.enabled)(a)),Fe(r)),r.case=a=>(o.enabled=a==="sensitive",r),r.not={assert:t(!0),allowed:(...a)=>(e.push(Xe(!0,o.enabled)(a)),r),matches:a=>(e.push(eo(!0)(a)),r),empty:()=>(e.push(Ze(!0)()),r),equals:a=>(e.push(Ye(!0,o.enabled)(a)),r)},r}function ce(...n){return(e,o="")=>{let r=[];for(let t of n){let a=t(e,o);if(!a.hasError)return a;r.push(a)}return{hasError:!0,initialValue:e,error:r}}}function le(n=[]){let e=v([],n,(o,r="")=>{if(o!==void 0)throw new h(r,`Value ${o} is not undefined`)});return e.toString=D(e,()=>String(void 0)),e.toNumber=I(e,()=>NaN),e.toBoolean=P(e,()=>!!void 0),e.toCustom=b(e),e.toArray=N(e),e}function de(...n){return ce(le(),...n)}function pe(n=[]){let e=[],o=v(e,n,(t,a="")=>{if(t===null||typeof t!="object"||Array.isArray(t))throw new h(a,`Value ${t} is not an object`)});o.toString=D(o,t=>String(t)),o.toNumber=I(o,t=>Number(t)),o.toBoolean=P(o,t=>!!t),o.toCustom=b(o);let r=t=>(a,i)=>(e.push(U(t,a,"object",i)),o);return o.assert=r(!1),o.not={assert:r(!0)},o.schema=function(t){return pe([(a,i="")=>{let R=o(a,i);if(R.hasError)throw R.error;let w={...a??{},...R.result},L=Object.entries(t).map(([S,V])=>[S,V(w[S],[i,S].filter(Boolean).join("."))]),$=L.filter(([,S])=>S.hasError);if($.length>0)throw $.reduce((S,[V,O])=>(S[V]=O,S),{});return L.reduce((S,[V,O])=>(O.hasError||(S[V]=O.result),S),w)}])},o.partial=function(t){return pe([(a,i="")=>{let R=o(a,i);if(R.hasError)throw R.error;let w={...a??{},...R.result},L=Object.entries(t).map(([S,V])=>{let O=de(V)(w[S],[i,S].filter(Boolean).join("."));return O.hasError&&console.error("ERROR IS HERE",O.error),[S,O]}),$=L.filter(([,S])=>S.hasError);if($.length>0)throw $.reduce((S,[V,O])=>(S[V]=O,S),{});return L.reduce((S,[V,O])=>(O.hasError||O.result!==void 0&&(S[V]=O.result),S),w)}])},o}function no(n=[]){let e=v([],n,(o,r="")=>{if(o!==null)throw new h(r,`Value ${o} is not null`)});return e.toString=D(e,()=>String(null)),e.toNumber=I(e,()=>0),e.toBoolean=P(e,()=>!!null),e.toCustom=b(e),e}function ro(){let n=v([],[],(e,o="")=>{if(e!==null)throw new h(o,`Value ${e} is not an error`)});return n.toString=D(n,e=>String(e)),n.toNumber=I(n,()=>0),n.toBoolean=P(n,()=>!!null),n.toCustom=b(n),n}function to(n){let e=(o,r="")=>{if(!o||typeof o!="object"||Array.isArray(o))return{initialValue:o,hasError:!0,error:new h(r,`Value ${o} is not a record`)};let t=Object.entries(o).map(([a,i],R)=>n(i,[a,`[${R}]`].filter(Boolean).join(".")));return t.some(a=>a.hasError)?{initialValue:o,hasError:!0,error:t.filter(a=>a.hasError)}:{hasError:!1,initialValue:o,result:o}};return e.toString=D(e,o=>String(o)),e.toNumber=I(e,o=>Number(o)),e.toBoolean=P(e,o=>!!o),e.toCustom=b(e),e.toArray=N(e),e}var s={string:ue,number:se,boolean:ae,array:Z,object:pe,error:ro,null:no,undefined:le,oneof:ce,stringUnion:ie,record:to,optional:de,anything:()=>n=>({initialValue:n,hasError:!1,result:n})};function B(n){return e=>!n(e).hasError}function Ce(n){return!!(n&&typeof n=="object"&&!Array.isArray(n))}function ye(n){return{success:!1,error:n}}function _e(n){return{success:!0,value:n}}function ao(n){try{let e=n();return so(e)?e:_e(e)}catch(e){return ye(e)}}async function oe(n){try{let e=await n();return so(e)?e:_e(e)}catch(e){return ye(e)}}function so(n){return Ce(n)&&typeof n.success=="boolean"&&(n.success&&"value"in n||!n.success&&"error"in n)}function io(n){return ao(()=>JSON.stringify(n))}var H=class extends Error{_error;_type;_state;constructor(e){super(typeof e=="string"?e:void 0),this._error=typeof e=="string"?this:e,this._type=H.SerializedType}toJSON(){return{__serialized_type:this._type,stack:this._error.stack,message:this._error.message,name:this._error.name,state:this._state}}static create(e){if(e instanceof Error)return new H(e);if(typeof e=="string"||typeof e=="boolean"||typeof e=="number"||typeof e=="symbol"||typeof e=="bigint"||typeof e=="function")return new H(e.toString());if(Io(e))return Po(e);let o=io(e);return o.success?new H(o.value):new H("Unserializeable data error")}setState(e){this._state=e}},W=H;X(W,"SerializedType","JSONableError");var Do=s.object().schema({__serialized_type:s.string().equals(W.SerializedType),stack:s.optional(s.string()),message:s.string(),name:s.string(),state:s.anything()}),Io=B(Do);function Po(n){let e=new Error;return e.stack=n.stack,e.name=n.name,e.message=n.message,new W(e)}var Ee=class extends W{constructor(e,o={}){super(`Expected [${e}] response was not valid`),this._type=Ee.SerializedType,this.setState({expectedType:e,errors:o})}},me=Ee;X(me,"SerializedType","UnexpectedResponseError");var Ao=s.object().schema({__serialized_type:s.string().equals(me.SerializedType),stack:s.optional(s.string()),message:s.string(),name:s.string(),state:s.object().schema({expectedType:s.string(),errors:s.record(s.string())})}),Ql=B(Ao);function z(...n){}var Mo=console,uo=Mo;var co=u!=="all"?u.map(n=>n.split(".")):null,J=uo;globalThis.console=new Proxy(J,{get:()=>z});function lo(n){return co&&!Lo(n,co)?{log:z,warn:z,error:(e,...o)=>J.error(`[${n}] ${e}`,...o),info:z,debug:z}:{log:(e,...o)=>J.log(`[${n}] ${e}`,...o),warn:(e,...o)=>J.warn(`[${n}] ${e}`,...o),error:(e,...o)=>J.error(`[${n}] ${e}`,...o),info:(e,...o)=>J.info(`[${n}] ${e}`,...o),debug:(e,...o)=>J.debug(`[${n}] ${e}`,...o)}}function Lo(n,e){let o=n.split(".");for(let r of e){let t=0,a=!0;for(;t<o.length;){if(r[t]==="*"){if(r.length-1===t){a=!0;break}t+=1;continue}if(r[t]===o[t]){t+=1;continue}a=!1;break}if(a)return!0}return!1}var Uo=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ke={randomUUID:Uo};var ge,Oo=new Uint8Array(16);function he(){if(!ge&&(ge=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ge))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ge(Oo)}var A=[];for(let n=0;n<256;++n)A.push((n+256).toString(16).slice(1));function po(n,e=0){return(A[n[e+0]]+A[n[e+1]]+A[n[e+2]]+A[n[e+3]]+"-"+A[n[e+4]]+A[n[e+5]]+"-"+A[n[e+6]]+A[n[e+7]]+"-"+A[n[e+8]]+A[n[e+9]]+"-"+A[n[e+10]]+A[n[e+11]]+A[n[e+12]]+A[n[e+13]]+A[n[e+14]]+A[n[e+15]]).toLowerCase()}function No(){if(ke.randomUUID)return ke.randomUUID();let n=he();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,po(n)}var mo=No;var Te=mo;function j(n){return s.object().schema({target:s.string().equals("background-core"),data:n??s.anything()}).partial({module_source:s.string()})}var $o=j(),Df=B($o);var Vo=j(s.string().equals("request-logout")),jo=j(s.string().equals("request-login"));var If=B(Vo),Pf=B(jo);var zo=s.string().equals("event_propagation"),ne=s.object().schema({type:zo,event:s.object().schema({type:s.string(),data:s.anything()})}),Xf=B(ne);var qo=j(ne),Cx=B(qo);var fe=s.string().equals("runtime");function Be(n){return s.object().schema({target:fe,data:n??s.anything()})}var Ko=Be(),go=B(Ko);var Go=Be(s.object().schema({type:s.string().equals("exposed_event_callback"),source_id:s.string(),args:s.array().items(s.anything())})),fo=B(Go);var Wo=Be(s.object().schema({type:s.string().equals("core_event_callback"),source_id:s.string(),args:s.array().items(s.anything())})),Ox=B(Wo);var Ho=j(s.object().schema({type:s.string().equals("execute_exposed_function"),fn:s.object().schema({name:s.string(),args:s.array()})})),sF=B(Ho);function xo(n,e,o){return{target:"background-core",data:{type:"execute_exposed_function",fn:{name:n,args:e}},module_source:o}}var Jo=j(s.object().schema({type:s.string().equals("execute_core_function"),fn:s.object().schema({module:s.string(),name:s.string(),args:s.array()})})),iF=B(Jo);var Qo=j(s.object().schema({type:s.string().equals("requested_exposed_function_availability"),fn:s.string()})),uF=B(Qo);var Yo=j(s.object().schema({type:s.string().equals("exposed_event_call"),source:s.object().schema({id:s.string(),target:s.oneof(fe)}),event_name:s.string(),listener_action:s.string().allowed("add","remove")})),cF=B(Yo);function Re(n,e,o){return{target:"background-core",data:{type:"exposed_event_call",event_name:n,listener_action:e,source:o}}}var Xo=j(s.object().schema({type:s.string().equals("core_event_call"),source:s.object().schema({id:s.string(),target:s.oneof(fe)}),module_name:s.string(),event_name:s.string(),listener_action:s.string().allowed("add","remove")})),lF=B(Xo);var Zo=s.string().equals("content-core");function be(n){return s.object().schema({target:Zo,data:n??s.anything()})}var en=be(),JF=B(en);var on=be(ne),fC=B(on);var nn=s.object().schema({source:s.string().equals("tab-worker"),tab_id:s.number()}),rn=s.object().schema({source:s.string().equals("unspecified")}),tn=s.oneof(nn,rn),Fo=s.string().equals("module");function an(n){return s.object().schema({target:Fo,module:s.string(),source:tn,data:n??s.anything()})}var sn=an(),un=s.object().schema({target:s.string().equals("module_event_forward"),module:s.string(),event:s.string(),args:s.array().items(s.anything())});var ZC=B(un),cn=s.object().schema({target:s.string().equals("exposed_event_forward"),module_source:s.string(),event:s.string(),args:s.array().items(s.anything())});var Co=B(cn),ey=B(Fo),oy=B(sn);var ln=s.object().schema({target:s.string().equals("module_direct_call"),module:s.string(),call:s.object().schema({name:s.string(),args:s.array()})}),ny=B(ln);async function T(n,e){return await oe(()=>M.runtime.sendMessage(xo(n,e)))}var q={coreEventListeners:new Map,eventListeners:new Map,eventListenersReverse:new Map};M.runtime.onMessage.addListener(n=>{if(Co(n)){let o=q.coreEventListeners.get(n.module_source)?.get(n.event)??[];return void Promise.allSettled(o.map(r=>r(...n.args)))}if(!go(n)||!fo(n))return;let e=q.eventListeners.get(n.data.source_id);e&&e(...n.data.args)});async function Q(n,e){let o=Te();q.eventListeners.set(o,e),q.eventListenersReverse.set(e,o),(await oe(()=>M.runtime.sendMessage(Re(n,"add",{id:o,target:"runtime"})))).success||(q.eventListeners.delete(o),q.eventListenersReverse.delete(e))}async function Y(n,e){let o=q.eventListenersReverse.get(e);if(!o)return;(await oe(()=>M.runtime.sendMessage(Re(n,"remove",{id:o,target:"runtime"})))).success,q.eventListeners.delete(o),q.eventListenersReverse.delete(e)}var yo={clearEmailNotificationsFromStorage:()=>T("clearEmailNotificationsFromStorage",[]),analyzeFileFromBytes:(n,e,o,r)=>T("analyzeFileFromBytes",[n,e,o,r]),analyzeFileFromURL:(n,e,o,r)=>T("analyzeFileFromURL",[n,e,o,r]),analyzeFileFromOPFS:(n,e,o,r)=>T("analyzeFileFromOPFS",[n,e,o,r]),removeMacroFromFileBuffer:(n,e)=>T("removeMacroFromFileBuffer",[n,e]),removeMacroFromOPFSFile:(n,e)=>T("removeMacroFromOPFSFile",[n,e]),runFileConversionFromBytes:(n,e,o,r)=>T("runFileConversionFromBytes",[n,e,o,r]),runFileConversionFromURL:(n,e,o,r)=>T("runFileConversionFromURL",[n,e,o,r]),launchSession:(n,e)=>T("launchSession",[n,e]),terminateSession:n=>T("terminateSession",[n]),getStoredSessions:()=>T("getStoredSessions",[]),getExistingSession:n=>T("getExistingSession",[n]),upsertTaskNotification:(n,{id:e,type:o,message:r})=>T("upsertTaskNotification",[n,{id:e,type:o,message:r}]),hideTaskNotificationForId:(n,e)=>T("hideTaskNotificationForId",[n,e]),discoverUrlProperties:n=>T("discoverUrlProperties",[n]),queryIpDetails:n=>T("queryIpDetails",[n]),getKnownRedirectDomains:()=>T("getKnownRedirectDomains",[]),getRedirectInformationForUrl:(n,e,o)=>T("getRedirectInformationForUrl",[n,e,o]),storeNewDlpCredential:(n,e)=>T("storeNewDlpCredential",[n,e]),isDomainTrustedByDlp:n=>T("isDomainTrustedByDlp",[n]),addEmptyDlpDomain:n=>T("addEmptyDlpDomain",[n]),getAllDlpCredentials:()=>T("getAllDlpCredentials",[]),findDlpDomainsForCredentials:n=>T("findDlpDomainsForCredentials",[n]),removeDlpDomainRecord:n=>T("removeDlpDomainRecord",[n]),removeDlpDomainRecordCredential:(n,e)=>T("removeDlpDomainRecordCredential",[n,e]),forgetTabTracking:n=>T("forgetTabTracking",[n]),launchDisposableBrowser:(n,e)=>T("launchDisposableBrowser",[n,e]),launchDisposableFileViewer:n=>T("launchDisposableFileViewer",[n]),browserDownloadFromUrl:n=>T("browserDownloadFromUrl",[n]),openDocumentScanResultsDialog:({tabId:n,fileName:e,claimedMime:o,result:r,cached:t,trigger:a,rawFile:i,lazyFetchFile:R,passwords:w})=>T("openDocumentScanResultsDialog",[{tabId:n,fileName:e,claimedMime:o,result:r,cached:t,trigger:a,rawFile:i,lazyFetchFile:R,passwords:w}]),openInExternalAppFromBytes:(n,e,o,r,t)=>T("openInExternalAppFromBytes",[n,e,o,r,t]),openInExternalAppFromURL:(n,e,o,r,t)=>T("openInExternalAppFromURL",[n,e,o,r,t]),getPendingRedirectionInfo:n=>T("getPendingRedirectionInfo",[n]),onSessionReady:{addListener:n=>Q("onSessionReady",n),removeListener:n=>Y("onSessionReady",n)},onSessionLaunchFailed:{addListener:n=>Q("onSessionLaunchFailed",n),removeListener:n=>Y("onSessionLaunchFailed",n)},onDlpDomainRecordAdded:{addListener:n=>Q("onDlpDomainRecordAdded",n),removeListener:n=>Y("onDlpDomainRecordAdded",n)},onDlpDomainRecordRemoved:{addListener:n=>Q("onDlpDomainRecordRemoved",n),removeListener:n=>Y("onDlpDomainRecordRemoved",n)},onDlpDomainCredentialRemoved:{addListener:n=>Q("onDlpDomainCredentialRemoved",n),removeListener:n=>Y("onDlpDomainCredentialRemoved",n)},onUploadEvent:{addListener:n=>Q("onUploadEvent",n),removeListener:n=>Y("onUploadEvent",n)},onDownloadReplayMismatch:{addListener:n=>Q("onDownloadReplayMismatch",n),removeListener:n=>Y("onDownloadReplayMismatch",n)}};async function _o(){let n={active:!0,lastFocusedWindow:!0},[e]=await M.tabs.query(n);return e?.id}var we=class{#e(e){let o=document.createElement("script");return o.src=M.runtime.getURL(`${e}/${e}.esm.js`),o.type="module",o.dataset.resourcesUrl=M.runtime.getURL(`${e}/`),o.dataset.stencilNamespace=e,o.id=e,o}defineElement(e){return Array.isArray(e)?e.map(o=>this.#e(o)):this.#e(e)}},Eo=new we;var dn=new URLSearchParams(window.location.search),Se=dn.get("url"),xe=lo("t.redirector");Se?xe.log("Redirecting...",window.atob(Se)):xe.error("Missing redirect location");(async function(){if(!document.head.querySelector("script#sqrx-dialog")){let i=Eo.defineElement("sqrx-dialog");document.head.append(i)}let e=await _o();if(!e)return;let o=await yo.getPendingRedirectionInfo(e);if(!o.success){xe.error("Failed to get redirect url",o.error);return}if(!o.value){xe.error("No redirect url");return}let{tabId:r,url:t}=o.value,a=Ie({confirmText:"Continue",dismissText:"Cancel",title:"Leaving Enhanced Privacy Mode",messages:["You're leaving Enhanced Privacy Mode.","Only proceed if you trust the source; the link opens in your browser",`${window.atob(Se??"")}...`],onConfirm:()=>{M.tabs.create({url:t}),M.tabs.remove(r,z)},onDismiss:()=>{M.tabs.remove(r,z)}});document.body.append(a)})();})();
