"use strict";(()=>{var lr=Object.defineProperty;var cr=(t,r,e)=>r in t?lr(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var H=(t,r,e)=>(cr(t,typeof r!="symbol"?r+"":r,e),e);var u=[];var fr=function(t,r,e,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?t!==r||!o:!r.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(t,e):o?o.value=e:r.set(t,e),e},pr=function(t,r,e,n){if(e==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?t!==r||!n:!r.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?n:e==="a"?n.call(t):n?n.value:r.get(t)},ne,i=class extends Error{constructor(r,e){super(e),ne.set(this,void 0),fr(this,ne,r,"f")}get key(){return pr(this,ne,"f")}};ne=new WeakMap;function M(t,r,e){return(n,o="")=>{try{let s=r.reduce((a,l)=>l(a,o),n);return e?.(s,o),br(o,t,s)}catch(s){return xe(n,s)}}}function xe(t,r){return{initialValue:t,hasError:!0,error:r}}function br(t,r,e){try{return r.forEach(n=>n(e,t)),{initialValue:e,result:e,hasError:!1}}catch(n){return xe(e,n)}}var W=(t,r,e,n)=>(o,s="")=>{if(!(t?!r(o):r(o)))throw new i(s,`${e??typeof o} '${o}' ${t?"is":"is not"} ${n}`)};function dr(t,r,e,n){return`${t} ${r} is${n?" ":" not "}${e}`}function U(t){return(r,e,n,o,s)=>{if(!e())throw new i(r,dr(t,n,o,s))}}var oe=U("array"),Te=t=>r=>(e,n="")=>{oe(n,()=>t?e.length!==r:e.length===r,`of length ${e.length}`,`of exact length ${r}`,t)},yr=t=>r=>(e,n="")=>{oe(n,()=>t?e.length<r:e.length>=r,`of length ${e.length}`,`within minimum length of ${r}`,t)},gr=t=>r=>(e,n="")=>{oe(n,()=>t?e.length>r:e.length<=r,`of length ${e.length}`,`within maximum length of ${r}`,t)},ke=t=>()=>(r,e="")=>{oe(e,()=>t?r.length!==0:r.length===0,`of length ${r.length}`,"empty",t)};function Y(t=[]){let r=[],e=M(r,t,(n,o="")=>{if(!Array.isArray(n))throw new i(o,`Value ${n} is not an array`)});return e.toString=$(e,n=>n.join(", ")),e.toNumber=P(e,n=>Number(n)),e.toBoolean=I(e,n=>!!n),e.toCustom=z(e),e.assert=(n,o)=>(r.push(W(!1,n,"array",o)),e),e.ofExactLength=n=>(r.push(Te(!1)(n)),e),e.ofMinLength=n=>(r.push(yr(!1)(n)),e),e.ofMaxLength=n=>(r.push(gr(!1)(n)),e),e.empty=()=>(r.push(ke(!1)()),e),e.not={assert:(n,o)=>(r.push(W(!0,n,"array",o)),e),empty:()=>(r.push(ke(!0)()),e),ofExactLength:n=>(r.push(Te(!0)(n)),e)},e.items=function(n){return Y([(o,s="")=>{let a=e(o,s);if(a.hasError)throw a.error;let l=a.result.map((E,F)=>n(E,[s,`[${F}]`].filter(Boolean).join(".")));if(l.some(E=>E.hasError))throw l.filter(E=>E.hasError);return l.reduce((E,F)=>(F.hasError||E.push(F.result),E),[])}])},e}var Se=U("boolean"),Ae=t=>()=>(r,e="")=>{Se(e,()=>t?!r:r,r,"true",t)},Ee=t=>()=>(r,e="")=>{Se(e,()=>t?r:!r,r,"false",t)};function se(t=[]){let r=[],e=M(r,t,(o,s="")=>{if(typeof o!="boolean")throw new i(s,`Value ${o} is not a boolean`)});e.toString=$(e,o=>o.toString()),e.toNumber=P(e,o=>o?1:0),e.toBoolean=I(e,o=>o),e.toCustom=z(e),e.toArray=B(e);let n=o=>(s,a)=>(r.push(W(o,s,"boolean",a)),e);return e.assert=n(!1),e.true=()=>(r.push(Ae(!1)()),G(!0,e)),e.false=()=>(r.push(Ee(!1)()),G(!1,e)),e.not={assert:n(!0),true:()=>(r.push(Ae(!0)()),G(!1,e)),false:()=>(r.push(Ee(!0)()),G(!0,e))},e}function Re(t=[]){let e=M([],t,(n,o="")=>{if(typeof n!="boolean")throw new i(o,`Value ${n} is not a boolean`);if(n!==!1)throw new i(o,`Value ${n} must be false`)});return e.toString=$(e,n=>n.toString()),e.toNumber=P(e,n=>n?1:0),e.toBoolean=I(e,n=>n),e.toCustom=z(e),e.toArray=B(e),e}function ze(t=[]){let e=M([],t,(n,o="")=>{if(typeof n!="boolean")throw new i(o,`Value ${n} is not a boolean`);if(n!==!0)throw new i(o,`Value ${n} must be true`)});return e.toString=$(e,n=>n.toString()),e.toNumber=P(e,n=>n?1:0),e.toBoolean=I(e,n=>n),e.toCustom=z(e),e.toArray=B(e),e}function Me(t=[]){let r=[],e=M(r,t);e.toString=$(e,()=>""),e.toNumber=P(e,()=>0),e.toBoolean=I(e,()=>!1),e.toCustom=z(e),e.toArray=B(e);let n=o=>(s,a)=>(r.push(W(o,s,"custom value",a)),e);return e.assert=n(!1),e.not={assert:n(!0)},e}var L=U("number"),$e=t=>r=>(e,n="")=>{if(!(t?r.indexOf(e)===-1:r.indexOf(e)!==-1))throw new i(n,`Number value ${e} ${t?`is one of the disallowed values in [${r.join(", ")}]`:`is not one of the allowed values in [${r.join(", ")}]`}`)},Pe=t=>()=>(r,e="")=>{L(e,()=>t?r<0:r>0,r,"positive",t)},Ie=t=>()=>(r,e="")=>{L(e,()=>t?r>0:r<0,r,"negative",t)},Ne=t=>()=>(r,e="")=>{L(e,()=>t?r!==0:r===0,r,"zero",t)},Fe=t=>r=>(e,n="")=>{L(n,()=>t?e>=r:e<r,e,`less than ${r}`,t)},We=t=>r=>(e,n="")=>{L(n,()=>t?e<=r:e>r,e,`more than ${r}`,t)},Be=t=>r=>(e,n="")=>{L(n,()=>t?e!==r:e===r,e,`equal to ${r}`,t)},Oe=t=>r=>(e,n="")=>{L(n,()=>t?e%r!==0:e%r===0,e,`a multiple of ${r}`,t)},Ve=t=>()=>(r,e="")=>{L(e,()=>t?!Number.isInteger(r):Number.isInteger(r),r,"an integer",t)};function ae(t=[]){let r=[],e=M(r,t,(o,s="")=>{if(typeof o!="number")throw new i(s,`Value ${o} is not a number`)});e.toString=$(e,o=>o.toString()),e.toNumber=P(e,o=>o),e.toBoolean=I(e,o=>o!==0),e.toCustom=z(e),e.toArray=B(e);let n=o=>(s,a)=>(r.push(W(o,s,"number",a)),e);return e.assert=n(!1),e.allowed=(...o)=>(r.push($e(!1)(o)),e),e.integer=()=>(r.push(Ve(!1)()),e),e.positive=()=>(r.push(Pe(!1)()),e),e.negative=()=>(r.push(Ie(!1)()),e),e.lessThan=o=>(r.push(Fe(!1)(o)),e),e.moreThan=o=>(r.push(We(!1)(o)),e),e.zero=()=>(r.push(Ne(!1)()),e),e.multipleOf=o=>(r.push(Oe(!1)(o)),e),e.equals=o=>(r.push(Be(!1)(o)),e),e.not={assert:n(!0),allowed:(...o)=>(r.push($e(!0)(o)),e),integer:()=>(r.push(Ve(!0)()),e),positive:()=>(r.push(Pe(!0)()),e),negative:()=>(r.push(Ie(!0)()),e),lessThan:o=>(r.push(Fe(!0)(o)),e),moreThan:o=>(r.push(We(!0)(o)),e),zero:()=>(r.push(Ne(!0)()),e),multipleOf:o=>(r.push(Oe(!0)(o)),e),equals:o=>(r.push(Be(!0)(o)),e)},e}function ie(t=[]){let r=[],e=M(r,t);e.toCustom=z(e);let n=o=>(s,a)=>(r.push(W(o,s,"custom value",a)),e);return e.assert=n(!1),e.not={assert:n(!0)},e}function $(t,r){return(e=r)=>ue([(n,o="")=>{let s=t(n,o);if(s.hasError)throw s.error;try{return e(s.result)}catch(a){throw new i(o,`Unable to create a string from ${typeof s.result} ${s.result}

 ${a instanceof Error?a.message:a}`)}}])}function P(t,r){return(e=r)=>ae([(n,o="")=>{let s=t(n,o);if(s.hasError)throw s.error;try{return e(s.result)}catch(a){throw new i(o,`Unable to create a number from ${typeof s.result} ${s.result}

 ${a instanceof Error?a.message:a}`)}}])}function I(t,r){return(e=r)=>se([(n,o="")=>{let s=t(n,o);if(s.hasError)throw s.error;try{return e(s.result)}catch(a){throw new i(o,`Unable to create a booolean from ${typeof s.result} ${s.result}

 ${a instanceof Error?a.message:a}`)}}])}function z(t){return r=>Me([(e,n="")=>{let o=t(e,n);if(o.hasError)throw o.error;try{return r(o.result)}catch(s){throw new i(n,`Unable to create custom type from ${typeof o.result} ${o.result}

 ${s instanceof Error?s.message:s}`)}}])}function B(t){return r=>Y([(e,n="")=>{let o=t(e,n);if(o.hasError)throw o.error;try{return r(o.result)}catch(s){throw new i(n,`Unable to create an array from ${typeof o.result} ${o.result}

 ${s instanceof Error?s.message:s}`)}}])}function ge(t){return ie([(r,e="")=>{let n=t(r,e);if(n.hasError)throw n.error;return r}])}function G(t,r){return(t?ze:Re)([(n,o="")=>{let s=r(n,o);if(s.hasError)throw s.error;return n}])}var Ke=U("string"),Ce=(t,r)=>e=>(n,o="")=>{Ke(o,()=>{let s=r?e:e.toLowerCase(),a=r?n:n.toLowerCase();return t?a!==s:a===s},n,"equal to",t)},je=(t,r)=>e=>(n,o="")=>{let s=r?e:e.map(E=>E.toLowerCase()),a=r?n:n.toLowerCase();if(!(t?s.indexOf(a)===-1:s.indexOf(a)!==-1))throw new i(o,`String value ${n} ${t?`is one of the disallowed values in [${e.join(", ")}]`:`is not one of the allowed values in [${e.join(", ")}]`}`)},Ue=t=>()=>(r,e="")=>{Ke(e,()=>t?r.length!==0:r.length===0,r,"empty",t)},Le=t=>r=>(e,n="")=>{if(!(t?!r.test(e):r.test(e)))throw new i(n,`String value '${e}' ${t?"matches":"does not match"} pattern ${r}`)};function ue(t=[]){let r=[],e={enabled:!0},n=M(r,t,(s,a="")=>{if(typeof s!="string")throw new i(a,`Value ${s} is not a string`)});n.toString=$(n,s=>s),n.toNumber=P(n,s=>Number(s)),n.toBoolean=I(n,s=>!!s),n.toCustom=z(n),n.toArray=B(n);let o=s=>(a,l)=>(r.push(W(s,a,"string",l)),n);return n.assert=o(!1),n.allowed=(...s)=>(r.push(je(!1,e.enabled)(s)),ge(n)),n.matches=s=>(r.push(Le(!1)(s)),n),n.empty=()=>(r.push(Ue(!1)()),n),n.equals=s=>(r.push(Ce(!1,e.enabled)(s)),ge(n)),n.case=s=>(e.enabled=s==="sensitive",n),n.not={assert:o(!0),allowed:(...s)=>(r.push(je(!0,e.enabled)(s)),n),matches:s=>(r.push(Le(!0)(s)),n),empty:()=>(r.push(Ue(!0)()),n),equals:s=>(r.push(Ce(!0,e.enabled)(s)),n)},n}function le(...t){return(r,e="")=>{let n=[];for(let o of t){let s=o(r,e);if(!s.hasError)return s;n.push(s)}return{hasError:!0,initialValue:r,error:n}}}function ce(t=[]){let r=M([],t,(e,n="")=>{if(e!==void 0)throw new i(n,`Value ${e} is not undefined`)});return r.toString=$(r,()=>String(void 0)),r.toNumber=P(r,()=>NaN),r.toBoolean=I(r,()=>!!void 0),r.toCustom=z(r),r.toArray=B(r),r}function me(...t){return le(ce(),...t)}function fe(t=[]){let r=[],e=M(r,t,(o,s="")=>{if(o===null||typeof o!="object"||Array.isArray(o))throw new i(s,`Value ${o} is not an object`)});e.toString=$(e,o=>String(o)),e.toNumber=P(e,o=>Number(o)),e.toBoolean=I(e,o=>!!o),e.toCustom=z(e);let n=o=>(s,a)=>(r.push(W(o,s,"object",a)),e);return e.assert=n(!1),e.not={assert:n(!0)},e.schema=function(o){return fe([(s,a="")=>{let l=e(s,a);if(l.hasError)throw l.error;let E={...s??{},...l.result},F=Object.entries(o).map(([R,O])=>[R,O(E[R],[a,R].filter(Boolean).join("."))]),V=F.filter(([,R])=>R.hasError);if(V.length>0)throw V.reduce((R,[O,N])=>(R[O]=N,R),{});return F.reduce((R,[O,N])=>(N.hasError||(R[O]=N.result),R),E)}])},e.partial=function(o){return fe([(s,a="")=>{let l=e(s,a);if(l.hasError)throw l.error;let E={...s??{},...l.result},F=Object.entries(o).map(([R,O])=>{let N=me(O)(E[R],[a,R].filter(Boolean).join("."));return N.hasError&&console.error("ERROR IS HERE",N.error),[R,N]}),V=F.filter(([,R])=>R.hasError);if(V.length>0)throw V.reduce((R,[O,N])=>(R[O]=N,R),{});return F.reduce((R,[O,N])=>(N.hasError||N.result!==void 0&&(R[O]=N.result),R),E)}])},e}function De(t=[]){let r=M([],t,(e,n="")=>{if(e!==null)throw new i(n,`Value ${e} is not null`)});return r.toString=$(r,()=>String(null)),r.toNumber=P(r,()=>0),r.toBoolean=I(r,()=>!!null),r.toCustom=z(r),r}function Je(){let t=M([],[],(r,e="")=>{if(r!==null)throw new i(e,`Value ${r} is not an error`)});return t.toString=$(t,r=>String(r)),t.toNumber=P(t,()=>0),t.toBoolean=I(t,()=>!!null),t.toCustom=z(t),t}function ve(t){let r=(e,n="")=>{if(!e||typeof e!="object"||Array.isArray(e))return{initialValue:e,hasError:!0,error:new i(n,`Value ${e} is not a record`)};let o=Object.entries(e).map(([s,a],l)=>t(a,[s,`[${l}]`].filter(Boolean).join(".")));return o.some(s=>s.hasError)?{initialValue:e,hasError:!0,error:o.filter(s=>s.hasError)}:{hasError:!1,initialValue:e,result:e}};return r.toString=$(r,e=>String(e)),r.toNumber=P(r,e=>Number(e)),r.toBoolean=I(r,e=>!!e),r.toCustom=z(r),r.toArray=B(r),r}var c={string:ue,number:ae,boolean:se,array:Y,object:fe,error:Je,null:De,undefined:ce,oneof:le,stringUnion:ie,record:ve,optional:me,anything:()=>t=>({initialValue:t,hasError:!1,result:t})};function D(t){return r=>!t(r).hasError}function qe(t){return!!(t&&typeof t=="object"&&!Array.isArray(t))}function pe(t){return{success:!1,error:t}}function Ze(t){return{success:!0,value:t}}function He(t){try{let r=t();return hr(r)?r:Ze(r)}catch(r){return pe(r)}}function hr(t){return qe(t)&&typeof t.success=="boolean"&&(t.success&&"value"in t||!t.success&&"error"in t)}function Ye(t){return He(()=>JSON.stringify(t))}var J=class extends Error{_error;_type;_state;constructor(r){super(typeof r=="string"?r:void 0),this._error=typeof r=="string"?this:r,this._type=J.SerializedType}toJSON(){return{__serialized_type:this._type,stack:this._error.stack,message:this._error.message,name:this._error.name,state:this._state}}static create(r){if(r instanceof Error)return new J(r);if(typeof r=="string"||typeof r=="boolean"||typeof r=="number"||typeof r=="symbol"||typeof r=="bigint"||typeof r=="function")return new J(r.toString());if(_r(r))return xr(r);let e=Ye(r);return e.success?new J(e.value):new J("Unserializeable data error")}setState(r){this._state=r}},C=J;H(C,"SerializedType","JSONableError");var wr=c.object().schema({__serialized_type:c.string().equals(C.SerializedType),stack:c.optional(c.string()),message:c.string(),name:c.string(),state:c.anything()}),_r=D(wr);function xr(t){let r=new Error;return r.stack=t.stack,r.name=t.name,r.message=t.message,new C(r)}var he=class extends C{constructor(r,e={}){super(`Expected [${r}] response was not valid`),this._type=he.SerializedType,this.setState({expectedType:r,errors:e})}},be=he;H(be,"SerializedType","UnexpectedResponseError");var Tr=c.object().schema({__serialized_type:c.string().equals(be.SerializedType),stack:c.optional(c.string()),message:c.string(),name:c.string(),state:c.object().schema({expectedType:c.string(),errors:c.record(c.string())})}),Ml=D(Tr);function q(...t){}var kr=console,Ge=kr;var Xe=u!=="all"?u.map(t=>t.split(".")):null,v=Ge;globalThis.console=new Proxy(v,{get:()=>q});function de(t){return Xe&&!Ar(t,Xe)?{log:q,warn:q,error:(r,...e)=>v.error(`[${t}] ${r}`,...e),info:q,debug:q}:{log:(r,...e)=>v.log(`[${t}] ${r}`,...e),warn:(r,...e)=>v.warn(`[${t}] ${r}`,...e),error:(r,...e)=>v.error(`[${t}] ${r}`,...e),info:(r,...e)=>v.info(`[${t}] ${r}`,...e),debug:(r,...e)=>v.debug(`[${t}] ${r}`,...e)}}function Ar(t,r){let e=t.split(".");for(let n of r){let o=0,s=!0;for(;o<e.length;){if(n[o]==="*"){if(n.length-1===o){s=!0;break}o+=1;continue}if(n[o]===e[o]){o+=1;continue}s=!1;break}if(s)return!0}return!1}var Er=de("m.file_analyzer"),S,Qe=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Qe.decode();var X=null;function re(){if(!S)throw new Error("WASM is not initialized");return(X===null||X.byteLength===0)&&(X=new Uint8Array(S.memory.buffer)),X}function we(t,r){return t=t>>>0,Qe.decode(re().subarray(t,t+r))}var j=new Array(128).fill(void 0);j.push(void 0,null,!0,!1);function er(t){return j[t]}var K=0,ye=typeof TextEncoder<"u"?new TextEncoder:{encode:()=>{throw Error("TextEncoder not available")}},Sr=typeof ye.encodeInto=="function"?function(t,r){return ye.encodeInto(t,r)}:function(t,r){let e=ye.encode(t);return r.set(e),{read:t.length,written:e.length}};function Rr(t,r,e){if(e===void 0){let l=ye.encode(t),E=r(l.length,1)>>>0;return re().subarray(E,E+l.length).set(l),K=l.length,E}let n=t.length,o=r(n,1)>>>0,s=re(),a=0;for(;a<n;a++){let l=t.charCodeAt(a);if(l>127)break;s[o+a]=l}if(a!==n){a!==0&&(t=t.slice(a)),o=e(o,n,n=a+t.length*3,1)>>>0;let l=re().subarray(o+a,o+n),E=Sr(t,l);a+=E.written}return K=a,o}function zr(t){return t==null}var Q=null;function Z(){if(!S)throw new Error("WASM is not initialized");return(Q===null||Q.byteLength===0)&&(Q=new Int32Array(S.memory.buffer)),Q}var te=j.length;function Mr(t){t<132||(j[t]=te,te=t)}function $r(t){let r=er(t);return Mr(t),r}function rr(t,r){let e=r(t.length*1,1)>>>0;return re().set(t,e/1),K=t.length,e}function tr(t,r,e,n){if(!S)throw new Error("WASM not initialized!");let o,s;try{let a=S.__wbindgen_add_to_stack_pointer(-16),l=rr(t,S.__wbindgen_malloc),E=K;S.analyze_macro(a,l,E,r,e,n?1:0);let F=Z()[a/4+0],V=Z()[a/4+1];return o=F,s=V,we(F,V)}finally{S.__wbindgen_add_to_stack_pointer(16),S.__wbindgen_free(o,s,1)}}var ee=null;function Pr(){if(!S)throw new Error("WASM not initialized!");return(ee===null||ee.byteLength===0)&&(ee=new Uint32Array(S.memory.buffer)),ee}function Ir(t){te===j.length&&j.push(j.length+1);let r=te;return te=j[r],j[r]=t,r}function Nr(t,r){let e=r(t.length*4,4)>>>0,n=Pr();for(let o=0;o<t.length;o++)n[e/4+o]=Ir(t[o]);return K=t.length,e}function nr(t,r,e,n,o,s){let a,l;if(!S)throw new Error("WASM not initialized!");try{let E=S.__wbindgen_add_to_stack_pointer(-16),F=rr(t,S.__wbindgen_malloc),V=K,R=Nr(r,S.__wbindgen_malloc),O=K;S.analyze_zip(E,F,V,R,O,e,n,o,s);let N=Z()[E/4+0],_e=Z()[E/4+1];return a=N,l=_e,we(N,_e)}finally{S.__wbindgen_add_to_stack_pointer(16),S.__wbindgen_free(a,l,1)}}async function Fr(t,r){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,r)}catch(n){if(t.headers.get("Content-Type")!="application/wasm")Er.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}let e=await t.arrayBuffer();return await WebAssembly.instantiate(e,r)}else{let e=await WebAssembly.instantiate(t,r);return e instanceof WebAssembly.Instance?{instance:e,module:t}:e}}function Wr(){let t={};return t.wbg={},t.wbg.__wbindgen_throw=function(r,e){throw new Error(we(r,e))},t.wbg.__wbindgen_string_get=function(r,e){let n=er(e),o=typeof n=="string"?n:void 0,s=(()=>{if(zr(o))return 0;if(!S)throw new Error("WASM is not initialized!");return Rr(o,S.__wbindgen_malloc,S.__wbindgen_realloc)})(),a=K;Z()[r/4+1]=a,Z()[r/4+0]=s},t.wbg.__wbindgen_object_drop_ref=function(r){$r(r)},t}function Br(t,r){return S=t.exports,or.__wbindgen_wasm_module=r,Q=null,ee=null,X=null,S}async function or(){if(S!==void 0)return S;let t="./module_statics/squarex_macroanalyzer_bg.wasm",r=Wr();let{instance:e,module:n}=await Fr(await fetch(t),r);return Br(e,n)}var sr=or;var Or=c.object().schema({call:c.string().equals("analyze_macro"),vba_stomping_detection:c.number(),max_ole_size:c.number(),is_old_format:c.boolean()}),ar=D(Or),Vr=c.object().schema({call:c.string().equals("analyze_zip"),passwords:c.array().items(c.string()),vba_stomping_detection:c.number(),max_level:c.number(),max_zip_size:c.number(),max_ole_size:c.number()}),ir=D(Vr);async function ur(t){self.postMessage("ready"),self.addEventListener("message",async r=>{let{bytes:e,parameters:n}=r.data;if(e!==null&&!(e instanceof Uint8Array))return pe("Invalid binary data");try{let o=await t(e,n);self.postMessage(o)}catch(o){self.postMessage(JSON.stringify(new C(o instanceof Error?o:String(o))))}})}var Bf=de("worker.analyze_macro_file");ur(async(t,r)=>{if(await sr(),!t)throw new Error("Missing file content to analyze");if(ar(r))return tr(t,r.vba_stomping_detection,r.max_ole_size,r.is_old_format);if(ir(r))return nr(t,r.passwords,r.max_level,r.vba_stomping_detection,BigInt(r.max_zip_size),r.max_ole_size);throw new Error("Unknown call or parameters")});})();
